{% extends "posts/base.html" %}

{% block headerentries %}
<li class="date right">
    <small>Published 9 VIII 2018</small>
</li>
{% endblock %}

{% block main %}
<header>
    <h1 class="section_h" id="ghc-tags-plugin">Ghc Tags Plugin</h1>
    <h3>Geting vim tags from Haskell's parsed tree</h3>

<p>
    Working on a large code base, which many type level features could be
    easier with a proper editor support.  Finding associated type class
    instances or open type families isn't easy at the moment.  Existing
    solutions like <a
        href="https://hackage.haskell.org/package/hasktags">hasktags</a> do not
    cover all the new language features, so at times one is left
    is searching the tree by hand.  Haskell IDE Engine, will hopefully deliver
    a very good solution, but at this time it is still very hard to find a good
    language client for <code>vim</code> which works out of the box.  Ghc plugin
    is a good fit for solving this problem:
    <ul>
        <li><code>CPP</code> pragmas are resolved</li>
        <li>it doesn't matter whether you write literate haskell or not</li>
        <li>contains accurate source information</li>
        <li>one can derive additional information: tag kind, whether its static or
            not (i.e. exported or not)
        </li>
        <li>regularly updated, as you build your project; possibly it could be
            integrated with <code>ghcid</code> <small>(I haven't tried
                yet)</small></li>
        <li>when GHC will give access to the code generated by
            <code>TemplateHaskell</code>, which might happen in the future,
            things like generated lenses will become discoverable.  This would
            solve one of the drawback of using template haskell.
        </li>
    </ul>

    In the future it could be even extended with type level information.
</p>

<p>
    Over last two weeks
    I worked out a quite nice solution: <a
        href="https://hackage.haskell.org/package/ghc-tags-plugin">ghc-tags-plugin</a>    

    It is using ghc <a
        href="https://ghc.gitlab.haskell.org/ghc/doc/users_guide/extending_ghc.html#compiler-plugins">plugin
        system</a>: at the moment only the part which has access to <a
        href="https://ghc.gitlab.haskell.org/ghc/doc/users_guide/extending_ghc.html#parsed-representation">parsed tree</a>.

    This allows to output tags for:
    <ul>
        <li>top level terms</li>
        <li>data types</li>
        <li>record fields</li>
        <li>type synonyms</li>
        <li>type classes</li>
        <li>type class members</li>
        <li>type class instances</li>
        <li>type families <i><small>standalone and associated</small></i></li>
        <li>type family instances <i><small>standalone and associated</small></i></li>
        <li>data type families <i><small>standalone and associated</small></i></li>
        <li>data type families instances <i><small>standalone and associated</small></i></li>
        <li>data type family instances constructors <i><small>standalone and associated</small></i></li>
    </ul>
</p>

<p>
    Its parser is compatible with output of <code>ctags</code>, if you want you
    could append tags generated by <code>ctags</code> (i.e. for <code>C</code> in
    your project).
</p>

<p>
    Installation is quite simple (and possibly can be still improved).  For
    <code>cabal</code> you don't need to modify checked files (only
    <code>cabal.project.local</code>). Check out the <a
        href="https://github.com/coot/ghc-tags-plugin/#plugin-configuration">readme</a>
    file for instructions.
</p>

<p>
    I have been using this plugin on a daily basis while working on <code>IOHK</code> code base which contains
<code><pre>
haskell:     214521 (96.22%)
ansic:         5285 (2.37%)
sh:            1868 (0.84%)
javascript:      1019 (0.46%)
cpp:            197 (0.09%)
perl:            63 (0.03%)
lisp:             7 (0.00%)
</pre></code>
    Navigating the codebase, re-discovering where things were moved after
    a refactoring, discovering code in far away from my area of expertise
    became much easier.
</p>

<p>
    Happy Haskelling!
</p>

</header>
{% endblock %}
